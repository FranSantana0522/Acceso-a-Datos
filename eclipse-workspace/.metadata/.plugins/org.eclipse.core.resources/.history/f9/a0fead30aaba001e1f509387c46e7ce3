package dao;

import java.util.List;
import javax.persistence.Query;
import javax.persistence.criteria.CriteriaBuilder;

import dominio.Prestamo;

public class PrestamoDao extends AbstractDao<Prestamo> {

	public PrestamoDao() {
		setClazz(Prestamo.class);
	}
	public List<Prestamo> getPrestamosNoDevueltos() {
	    List<Prestamo> prestamos = null;

	    try {
	        CriteriaBuilder cb = getEntityManager().getCriteriaBuilder();
	        CriteriaQuery<Prestamo> cq = cb.createQuery(Prestamo.class);

	        // Definir la entidad raíz y la condición
	        Root<Prestamo> prestamoRoot = cq.from(Prestamo.class);
	        Predicate condicion = cb.isNull(prestamoRoot.get("fechaDevolucion"));

	        // Construir la consulta
	        cq.select(prestamoRoot).where(condicion);

	        // Ejecutar la consulta
	        prestamos = getEntityManager().createQuery(cq).getResultList();
	    } catch (Exception e) {
	        e.printStackTrace();
	    }

	    return prestamos;
	}
}